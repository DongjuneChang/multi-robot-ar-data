# Photon Fusion2 Webhook Configuration
# 이 파일에서 이벤트 타입, 필드, 동작을 정의
# 코드 수정 없이 YAML만 변경하면 새 이벤트 추가 가능

# === 기본 설정 ===
webhook:
  # Photon에서 성공 응답으로 기대하는 코드
  success_code: 0
  error_code: 1

  # 이벤트 로그 최대 보관 개수
  max_log_size: 100

  # WebSocket 브로드캐스트 이벤트 이름
  broadcast_event: "fusion2_update"

# === 이벤트 정의 ===
# 각 이벤트에 대해:
#   - description: 설명
#   - required_fields: 필수 필드
#   - optional_fields: 선택 필드
#   - action: 수행할 액션 (create_room, close_room, add_player, remove_player)

events:
  CreateGame:
    description: "Photon 방 생성"
    action: "create_room"
    required_fields:
      - GameId
    optional_fields:
      - ActorCount
      - CreateOptions
    create_options_fields:
      - MaxPlayers
      - IsVisible
      - IsOpen

  CloseGame:
    description: "Photon 방 종료"
    action: "close_room"
    required_fields:
      - GameId
    optional_fields:
      - ActorCount

  JoinGame:
    description: "플레이어 방 입장"
    action: "add_player"
    required_fields:
      - GameId
      - UserId
    optional_fields:
      - Nickname
      - ActorNr
      - IsRejoining

  LeaveGame:
    description: "플레이어 방 퇴장"
    action: "remove_player"
    required_fields:
      - GameId
      - UserId
    optional_fields:
      - ActorNr
      - IsInactive  # true = 일시적 끊김, false = 완전 퇴장

# === 데이터 모델 ===
# 방과 플레이어 저장 구조 정의

models:
  room:
    fields:
      - room_id
      - created_at
      - closed_at
      - actor_count
      - max_players
      - state        # active, closed
      - players      # dict of player_id -> player_data

  player:
    fields:
      - user_id
      - nickname
      - room_id
      - actor_nr
      - joined_at
      - left_at
      - is_active

# === 통계 추적 ===
stats:
  track:
    - total_rooms_created
    - total_joins
    - total_leaves
    - webhook_calls
    - last_webhook
