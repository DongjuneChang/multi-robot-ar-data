# lite6 Robot Override Configuration
# 이 파일의 값이 _defaults.yaml을 덮어씀
#
# 검증일: 2025-12-03
# 검증 환경: Docker (serial-robot-control), ROS2 Humble, MoveIt2
#
# Launch 파일 경로:
#   - MoveIt: /workspace/src/xarm_ros2/xarm_moveit_config/launch/lite6_moveit_fake.launch.py
#   - Robot Controller: ros2/multi_hri_ros2_v3/multi_hri_launch/launch/single_robot.launch.py
#
# 주의사항:
#   - RViz 비활성화: `show_rviz:=false` 파라미터 사용 (use_rviz는 작동하지 않음)
#   - RViz가 실패하면 전체 launch가 종료됨 (OnProcessExit 핸들러)
#   - single_robot.launch.py는 MoveIt을 포함하지 않으므로 별도 실행 필요

robot:
  model: "lite6"
  manufacturer: "UFACTORY"
  dof: 6
  prefab_name: "lite6"

joints:
  names: ["joint1", "joint2", "joint3", "joint4", "joint5", "joint6"]
  positions:
    zero: [0, 0, 0, 0, 0, 0]
    home: [0, 35, 60, 0, 25, -20]
  limits:
    joint1: [-360, 360]
    joint2: [-118, 120]
    joint3: [-225, 11]
    joint4: [-360, 360]
    joint5: [-360, 360]
    joint6: [-360, 360]

frame_hierarchy:
  network_frames:
    "{robot_id}_base":
      ros_frame: "link_base"
    "{robot_id}_eef":
      ros_frame: "link_eef"
  local_frames:
    - "link1"
    - "link2"
    - "link3"
    - "link4"
    - "link5"
    - "link6"

ros2:
  prefab_links:
    link_base: "Base"
    link_eef: "EndEffector"
    link1: "Link1"
    link2: "Link2"
    link3: "Link3"
    link4: "Link4"
    link5: "Link5"
    link6: "Link6"

  external_frames:
    WorkFrame:
      parent: "link_base"

  subscribe_frames:
    - "world"
    - "robot_origin"
    - "link_base"
    - "link_eef"
    - "WorkFrame"
    - "link1"
    - "link2"
    - "link3"
    - "link4"
    - "link5"
    - "link6"

named_frames:
  frames:
    robot_origin:
      position: [0.087, 0.0, 0.154]  # FK at zero config (PyBullet verified)
    WorkFrame:
      position: [0.10, 0.0, 0.12]    # 10cm forward, 12cm up

visualization_config: "lite6_visualization"

# =============================================================================
# Control Configuration
# =============================================================================
control:
  type: "moveit"  # MoveIt2로 제어

  relay:
    actions:
      follow_joint_trajectory:
        from: "/{robot_id}/lite6_traj_controller/follow_joint_trajectory"
        to: "/lite6_traj_controller/follow_joint_trajectory"

    services:
      compute_ik:
        from: "/{robot_id}/compute_ik"
        to: "/compute_ik"
      compute_fk:
        from: "/{robot_id}/compute_fk"
        to: "/compute_fk"

    topics:
      joint_states:
        from: "/{robot_id}/joint_states"
        to: "/joint_states"
        direction: "bidirectional"

moveit:
  controller_name: "lite6_traj_controller"  # 검증 완료: /lite6_traj_controller/follow_joint_trajectory 액션 서버
  move_group: "lite6"  # 검증 완료: /compute_ik, /compute_fk 서비스 생성 확인

ros2_visualization:
  reference_frame: "link_base"

# =============================================================================
# 검증된 설정 값 (2025-12-03)
# =============================================================================
# - robot.dof: 6 ✅
# - joints.names: 6개 확인 ✅
# - control.type: moveit ✅
# - moveit.controller_name: lite6_traj_controller ✅
# - moveit.move_group: lite6 ✅
# - convert_to_radians: config_utils.py에서 자동 변환 (degrees → radians) ✅
# - home position (radians): [0.0, 0.610865, 1.047198, 0.0, 0.436332, -0.349066] ✅
#
# 검증된 ROS2 엔티티:
#   - 노드: /move_group, /robot_controller, /joint_state_relay ✅
#   - 토픽: /lite6_Q1/current_pose, /lite6_Q1/joint_states, /lite6_Q1/planned_joint_states,
#          /lite6_Q1/target_pose, /lite6_Q1/target_reached ✅
#   - 서비스: /robot/home, /robot/zero, /compute_ik, /compute_fk ✅
#   - 액션: /lite6_traj_controller/follow_joint_trajectory ✅
#
# 알려진 이슈:
#   - relay_node의 DOF 결정: 현재 num_joints 하드코딩 (기본값 5), config에서 읽어야 함
#   - single_robot.launch.py는 MoveIt을 포함하지 않음 (별도 실행 필요)
#   - MoveIt launch 파일이 use_rviz 파라미터를 지원하지 않음
