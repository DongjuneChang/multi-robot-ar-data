# Network Configuration for Multi-HRI System
# Unity & Python 공용 - 모든 서버 엔드포인트 정의
# 작성일: 2025-08-30
# 수정일: 2025-12-06
# 작성자: Dongjune Chang
#
# NOTE: Husarnet hostname 사용 (VPN 내에서만 resolve)
#       Husarnet 네트워크에 join된 기기에서만 접근 가능
#
# 각 서버는 물리적으로 다른 머신에 있을 수 있음:
#   - HoloLens ↔ ROS2 Server (Linux): TCP 직접 통신
#   - HoloLens ↔ Web Server (Flask): HTTP/WebSocket
#   - HoloLens ↔ AI Server (RILEY): ZMQ/HTTP

# === 서버 엔드포인트 ===
servers:
  # Web Panel 서버 (Flask)
  # Flask 자체 설정: web_panel/server_config.yaml
  web:
    host: "multi-hri.ngrok.app"
    port: 5000
    github_repo: "DongjuneChang/multi-robot-ar-data"

  # AI 서버들 (RILEY + LLM)
  # Provider 설정: ai/providers/*.yaml
  # Riley 설정: ai/_defaults.yaml
  # NOTE: Husarnet hostname 사용 (VPN 내에서만 resolve)
  #
  # 키 명명 규칙: users/*.yaml의 riley.server 참조용
  ai:
    # === Site ID 기반 ===

    # 로컬 개발 (같은 PC)
    localhost:
      type: "zmq"
      host: "127.0.0.1"
      zmq_pub_port: 5565      # Unity → Python
      zmq_sub_port: 5566      # Python → Unity
      ollama_port: 11434

    # 시카고 홈 (Alienware GPU)
    chicago_home:
      type: "zmq"
      host: "anl-alienware-18-area-51-aa18250"  # Husarnet hostname
      zmq_pub_port: 5565
      zmq_sub_port: 5566
      ollama_port: 11434

    # ANL 서버
    anl:
      type: "zmq"
      host: "anl-server"  # Husarnet hostname
      zmq_pub_port: 5565
      zmq_sub_port: 5566
      ollama_port: 11434

    # === 물리적 머신 Alias ===

    # ANL Alienware (chicago_home과 동일)
    alienware:
      type: "zmq"
      host: "anl-alienware-18-area-51-aa18250"
      zmq_pub_port: 5565
      zmq_sub_port: 5566
      ollama_port: 11434

    # === 특수 용도 ===

    # ngrok (HTTP 모드) - 외부 접근용
    ngrok:
      type: "http"
      host: "riley.multi-hri.ngrok.app"
      port: 5001

  # ROS2 서버들 (Linux Docker)
  # HoloLens ↔ ROS2 TCP 직접 통신
  # NOTE: Husarnet hostname 사용 (VPN 내에서만 resolve)
  #
  # 키 명명 규칙:
  #   - Site ID 기반 (users/*.yaml의 ros_server 참조용)
  #   - 물리적 머신 alias도 유지 (편의성)
  ros2:
    # === Site ID 기반 (사용자 config 참조용) ===

    # 시카고 홈 (dongjune_chang.yaml 참조)
    # Alienware PC에서 ROS2 Docker 실행
    chicago_home:
      host: "anl-alienware-18-area-51-aa18250"  # Husarnet hostname
      port: 10000

    # ANL 서버 (youngsoo_park.yaml 참조)
    anl:
      host: "anl-server"  # Husarnet hostname
      port: 10000

    # ASU NCHR (hyunglae_lee.yaml 참조)
    # TODO: Husarnet 설정 후 hostname 변경
    nchr_xarm5:
      host: "asu-nchr-server"  # Husarnet hostname (TBD)
      port: 10000

    # === 물리적 머신 Alias ===

    # ANL Alienware (chicago_home과 동일)
    alienware:
      host: "anl-alienware-18-area-51-aa18250"
      port: 10000

    # === 특수 용도 ===

    # 로컬 개발
    localhost:
      host: "127.0.0.1"
      port: 10000

    # HoloLens standalone용 (Lightsail TCP 프록시)
    # Lightsail에서 socat으로 Husarnet 서버에 포워딩
    lightsail:
      host: "54.180.154.177"  # Lightsail public IP
      port: 10000

  # Photon Fusion2 (멀티유저 동기화)
  photon:
    app_id: "165936a1-4ec1-421d-8930-399921013e1e"
    region: "us"
    room_name: "MultiHRI-Room"
    max_players: 10

# === 데이터 스트리밍 채널 ===
streaming:
  update_rate: 10  # Hz
  data_types:
    - user_pose
    - qr_update
    - robot_spawn

  modes:
    zmq_local:
      type: "zmq"
      host: "localhost"
      publish_port: 5567
      subscribe_port: 5568

    zmq_aggregator:
      type: "zmq"
      host: "stream.multi-hri.ngrok.app"
      publish_port: 5567
      subscribe_port: 5568

    websocket:
      type: "websocket"
      endpoint: "wss://stream.multi-hri.ngrok.app"

    disabled:
      type: "none"

# === 타임아웃 설정 ===
timeouts:
  ros_connection: 5000
  ai_connection: 3000
  streaming_connection: 2000
