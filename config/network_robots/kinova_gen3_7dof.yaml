# Kinova Gen3 7DOF Network Robot Configuration
# ICoordinateFrame-based hierarchy structure

robot:
  model: "kinova_gen3_7dof"
  manufacturer: "Kinova"
  id_pattern: "{model}_{anchor}"  # kinova_gen3_7dof_Q1

# Coordinate Frame Hierarchy (ICoordinateFrame 중심)
frame_hierarchy:
  # QR Frame 설정
  qr_frame_pattern: "QR_{anchor}"  # QR_Q1, QR_Q2 등

  # Robot 자체가 ICoordinateFrame (root)
  root_frame:
    type: "NetworkTF"           # NetworkTF로 통일 (ICoordinateFrame 구현)
    id: "{robot_id}"            # kinova_gen3_7dof_Q1
    parent: "QR_{anchor}"       # QR_Q1

  # 자식 NetworkTF 프레임들
  network_frames:
    "{robot_id}_base":
      ros_frame: "base_link"
      parent: "{robot_id}"      # Robot이 부모
      type: "NetworkTF"

    "{robot_id}_eef":
      ros_frame: "end_effector_link"
      parent: "{robot_id}_base"
      type: "NetworkTF"

    "{robot_id}_work":
      ros_frame: "WorkFrame"
      parent: "{robot_id}_base"
      type: "NetworkTF"
      critical: true            # Pose 계산 필수

  # ROS2 전용 프레임 (ICoordinateFrame 아님, 시각화만)
  local_frames:
    - "shoulder_link"           # Joint 1
    - "half_arm_1_link"         # Joint 2
    - "half_arm_2_link"         # Joint 3
    - "forearm_link"            # Joint 4
    - "spherical_wrist_1_link"  # Joint 5
    - "spherical_wrist_2_link"  # Joint 6
    - "bracelet_link"           # Joint 7

# ROS2 Settings
ros2:
  namespace: ""                 # Root namespace

  # ROS2 Topics
  topics:
    tf: "/tf"                   # Dynamic transforms
    tf_static: "/tf_static"     # Static transforms (URDF structure)
    joint_states: "/joint_states"

  # Prefab GameObject 매핑 (Prefab 내부의 실제 GameObject 이름)
  prefab_links:
    base_link: "Base"            # Prefab의 Base GameObject
    end_effector_link: "EndEffector"  # Prefab의 EndEffector GameObject
    shoulder_link: "Shoulder"
    half_arm_1_link: "HalfArm1"
    half_arm_2_link: "HalfArm2"
    forearm_link: "Forearm"
    spherical_wrist_1_link: "SphericalWrist1"
    spherical_wrist_2_link: "SphericalWrist2"
    bracelet_link: "Bracelet"

  # ROS2에서 받아올 외부 프레임 (Prefab에 없는 것들)
  external_frames:
    WorkFrame:
      parent: "base_link"
      topic: "/tf_static"       # WorkFrame은 tf_static으로 한번 발행
      critical: true            # 필수 프레임

    robot_origin:
      parent: "world"
      topic: "/tf"

  # 구독할 모든 프레임 (호환성 유지)
  subscribe_frames:
    - "world"
    - "robot_origin"
    - "base_link"
    - "end_effector_link"
    - "WorkFrame"
    - "shoulder_link"
    - "half_arm_1_link"
    - "half_arm_2_link"
    - "forearm_link"
    - "spherical_wrist_1_link"
    - "spherical_wrist_2_link"
    - "bracelet_link"

  # Joint 정보 (FK/IK 계산용)
  joints:
    names: ["joint_1", "joint_2", "joint_3", "joint_4", "joint_5", "joint_6", "joint_7"]
    limits:                     # degrees (Kinova Gen3 7DOF specific limits)
      joint_1: [-360, 360]
      joint_2: [-138, 138]
      joint_3: [-360, 360]
      joint_4: [-152, 152]
      joint_5: [-360, 360]
      joint_6: [-128, 128]
      joint_7: [-360, 360]

# 시각화는 ScriptableObject로 처리
visualization_config: "kinova_gen3_7dof_visualization"

# ROS2 시각화 설정 (robot_visualization_config.yaml에서 가져옴)
ros2_visualization:
  reference_frame: "base_link"  # 로봇별 참조 프레임 (world 대신 사용)
  features:
    show_current_pose: true
    show_target_pose: true
    show_path: true
  markers:
    sphere_scale: 0.05
    text_scale: 0.03
    path_line_width: 0.02
  colors:
    current: [1.0, 0.0, 0.0, 1.0]  # 빨간색 (현재 위치)
    target: [0.0, 0.0, 1.0, 1.0]   # 파란색 (타겟 포즈)
    path: [0.0, 1.0, 0.0, 0.8]     # 녹색 (경로)
    success: [0.0, 1.0, 0.0, 0.6]  # 녹색 (도달 완료)
    text: [1.0, 1.0, 1.0, 1.0]     # 흰색 (텍스트)


