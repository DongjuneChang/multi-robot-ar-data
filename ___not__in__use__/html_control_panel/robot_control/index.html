<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Robot Control</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <!-- Main Content -->
        <main class="main-content">
            <!-- Left Column: System Control -->
            <section class="panel system-control">
                <h2>System Control</h2>

                <!-- Robot & Connection Settings -->
                <div class="subsection connection-settings">
                    <h3>Connection</h3>
                    <div class="control-group">
                        <label for="robot-type">Robot Type:</label>
                        <select id="robot-type">
                            <option value="">Loading...</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label for="ros-server">ROS2 Server:</label>
                        <select id="ros-server">
                            <option value="">Select server...</option>
                        </select>
                    </div>
                    <div class="connection-info">
                        <span class="info-label">IP:</span>
                        <span id="connection-ip">-</span>
                        <span class="info-label">Port:</span>
                        <span id="connection-port">10000</span>
                    </div>
                </div>

                <!-- Mode Selection -->
                <div class="control-group">
                    <label>System Mode:</label>
                    <div class="radio-group">
                        <label><input type="radio" name="mode" value="fake" checked> Fake</label>
                        <label><input type="radio" name="mode" value="real"> Real</label>
                        <label><input type="radio" name="mode" value="gazebo"> Gazebo</label>
                    </div>
                </div>

                <!-- System Buttons Row 1 -->
                <div class="button-row">
                    <button id="btn-clean" class="btn btn-warning">Clean System</button>
                    <button id="btn-moveit" class="btn btn-primary" data-running="false">Launch MoveIt</button>
                    <button id="btn-controller" class="btn btn-primary" data-running="false">Launch Controller</button>
                </div>

                <!-- System Buttons Row 2 -->
                <div class="button-row">
                    <button id="btn-world-tf" class="btn btn-secondary" data-running="false">Add World TF</button>
                    <button id="btn-viz-system" class="btn btn-primary" data-running="false">Visualization System</button>
                    <span class="info-text">(current pose + path planner + markers)</span>
                </div>

                <!-- Path Planning Row -->
                <div class="button-row">
                    <button id="btn-start-path" class="btn btn-success" disabled>Start Path</button>
                    <button id="btn-stop-path" class="btn btn-danger" disabled>Stop Path</button>
                </div>

                <!-- Pattern Test Section -->
                <div class="subsection">
                    <h3>Pattern Test</h3>

                    <div class="control-group">
                        <label for="pattern-select">Pattern:</label>
                        <select id="pattern-select">
                            <option value="diamond">diamond</option>
                            <option value="square">square</option>
                            <option value="circle">circle</option>
                            <option value="spiral">spiral</option>
                            <option value="figure8">figure8</option>
                            <option value="triangle">triangle</option>
                            <option value="star">star</option>
                        </select>
                    </div>

                    <div class="control-group">
                        <label for="size-slider">Size (m):</label>
                        <input type="range" id="size-slider" min="0.05" max="0.5" step="0.01" value="0.2">
                        <span id="size-value">0.20</span>
                    </div>

                    <div class="control-group">
                        <label for="speed-slider">Speed:</label>
                        <input type="range" id="speed-slider" min="0.5" max="2.0" step="0.1" value="1.0">
                        <span id="speed-value">1.0x</span>
                    </div>

                    <div class="button-row">
                        <button id="btn-pattern-service" class="btn btn-primary" data-running="false">Launch Service</button>
                        <button id="btn-preview" class="btn btn-info" disabled>Preview Test</button>
                        <button id="btn-start-test" class="btn btn-success" disabled>Start Test</button>
                        <button id="btn-stop-test" class="btn btn-danger" disabled>Stop Test</button>
                    </div>
                </div>
            </section>

            <!-- Middle Column: AR Devices -->
            <section class="panel ar-devices">
                <h2>AR Devices (HoloLens/Quest)</h2>

                <div class="control-group">
                    <label>ROS2 Server IP:</label>
                    <input type="text" id="ros-server-ip" readonly value="Not detected">
                </div>

                <div class="button-row">
                    <button id="btn-tcp-endpoint" class="btn btn-primary" data-running="false">Launch TCP Endpoint</button>
                    <button id="btn-device-api" class="btn btn-primary" data-running="false">Start Device API</button>
                    <button id="btn-scan-devices" class="btn btn-secondary">Scan Devices</button>
                </div>

                <div class="control-group">
                    <label>Discovered Devices:</label>
                    <div class="device-list" id="device-list">
                        <p class="no-devices">No devices scanned</p>
                    </div>
                </div>

                <!-- Foxglove Connection -->
                <div class="subsection">
                    <h3>Foxglove Bridge</h3>
                    <div class="control-group">
                        <label>Status:</label>
                        <span id="foxglove-status" class="status-indicator status-stopped">Disconnected</span>
                    </div>
                    <div class="button-row">
                        <button id="btn-foxglove-connect" class="btn btn-primary">Connect Foxglove</button>
                        <button id="btn-foxglove-disconnect" class="btn btn-secondary" disabled>Disconnect</button>
                    </div>
                </div>
            </section>

            <!-- Right Column: System Status -->
            <section class="panel system-status">
                <h2>System Status</h2>

                <div class="status-list">
                    <div class="status-item">
                        <span class="status-label">ROS2:</span>
                        <span id="status-ros2" class="status-indicator status-stopped">Stopped</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">MoveIt:</span>
                        <span id="status-moveit" class="status-indicator status-stopped">Stopped</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Controller:</span>
                        <span id="status-controller" class="status-indicator status-stopped">Stopped</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">TCP Endpoint:</span>
                        <span id="status-tcp-endpoint" class="status-indicator status-stopped">Stopped</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">ROS2 Server IP:</span>
                        <span id="status-ros-ip" class="status-indicator status-stopped">Not detected</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Device API:</span>
                        <span id="status-device-api" class="status-indicator status-stopped">Not running</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">AR Devices:</span>
                        <span id="status-ar-devices" class="status-indicator status-stopped">Not scanned</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Pattern Service:</span>
                        <span id="status-pattern-service" class="status-indicator status-stopped">Stopped</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Test Running:</span>
                        <span id="status-test" class="status-indicator status-stopped">Stopped</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Foxglove:</span>
                        <span id="status-foxglove" class="status-indicator status-stopped">Disconnected</span>
                    </div>
                </div>

                <!-- Live Data from Foxglove -->
                <div class="subsection">
                    <h3>Live Robot Data</h3>
                    <div class="live-data">
                        <div class="data-item">
                            <label>Joint States:</label>
                            <pre id="joint-states-data">No data</pre>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Output Section -->
        <section class="panel output-panel">
            <h2>Output</h2>
            <div class="output-container">
                <pre id="output-log"></pre>
            </div>
            <div class="button-row output-controls">
                <button id="btn-clear-output" class="btn btn-secondary">Clear Output</button>
                <button id="btn-copy-output" class="btn btn-secondary">Copy Output</button>
            </div>
        </section>
    </div>

    <!-- JavaScript -->
    <script src="js/js-yaml.min.js"></script>
    <script src="js/api.js"></script>
    <script src="js/foxglove.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
