<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Monitoring</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <!-- Tabs -->
        <div class="tabs">
            <button class="tab active" data-tab="map">Map View</button>
            <button class="tab" data-tab="tracking">Real-time Tracking</button>
            <button class="tab" data-tab="camera">Camera Vision</button>
        </div>

        <!-- Tab: Map View -->
        <section id="map" class="tab-content active">
            <div class="section-header">
                <h2>2D Map View</h2>
                <div class="button-group">
                    <button class="btn btn-secondary" id="btn-center-map">Center</button>
                    <button class="btn btn-primary" id="btn-refresh-map">Refresh</button>
                    <button class="btn btn-secondary" id="btn-toggle-grid">Toggle Grid</button>
                </div>
            </div>

            <div id="map-container" class="map-container">
                <div class="map-grid" id="map-grid"></div>
                <canvas id="map-canvas"></canvas>
            </div>

            <div class="map-legend">
                <span class="legend-item"><span class="marker qr-marker"></span> QR Code</span>
                <span class="legend-item"><span class="marker user-marker"></span> User</span>
                <span class="legend-item"><span class="marker robot-marker"></span> Robot</span>
            </div>

            <!-- Data Tables -->
            <div class="data-section">
                <h3>QR Codes</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>QR ID</th>
                            <th>Registered By</th>
                            <th>Position</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="qr-table-body">
                        <tr><td colspan="4">Loading...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="data-section">
                <h3>Users</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>User</th>
                            <th>Device</th>
                            <th>Role</th>
                            <th>QR Access</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="user-table-body">
                        <tr><td colspan="5">Loading...</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Tab: Real-time Tracking -->
        <section id="tracking" class="tab-content">
            <div class="section-header">
                <h2>Real-time Tracking</h2>
                <div class="button-group">
                    <button class="btn btn-primary" id="btn-refresh-tracking">Refresh</button>
                    <span class="last-update">Last: <span id="tracking-last-update">-</span></span>
                </div>
            </div>

            <div class="data-section">
                <h3>Active Users</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>User</th>
                            <th>Position (X, Y)</th>
                            <th>Height (Z)</th>
                            <th>Activity</th>
                            <th>Active Robots</th>
                            <th>Last Seen</th>
                        </tr>
                    </thead>
                    <tbody id="tracking-user-table">
                        <tr><td colspan="6">Loading...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="data-section">
                <h3>Robot Telemetry</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Robot ID</th>
                            <th>Owner</th>
                            <th>Position</th>
                            <th>Battery</th>
                            <th>Status</th>
                            <th>Task</th>
                        </tr>
                    </thead>
                    <tbody id="robot-table-body">
                        <tr><td colspan="6">Loading...</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Tab: Camera Vision -->
        <section id="camera" class="tab-content">
            <div class="section-header">
                <h2>HoloLens Camera Vision</h2>
                <div class="button-group">
                    <button class="btn btn-secondary" id="btn-scan-cameras">Scan Devices</button>
                </div>
            </div>

            <div class="camera-grid" id="camera-grid">
                <!-- Dynamically generated camera cells -->
            </div>

            <div class="connection-info-box">
                <h4>Connection Status</h4>
                <p><span class="status-dot connected"></span> Device online and streaming</p>
                <p><span class="status-dot disconnected"></span> Device offline or connection failed</p>
            </div>
        </section>

        <!-- Log Panel -->
        <div class="log-panel">
            <div class="log-header">
                <span>System Log</span>
                <button class="btn-clear-log" id="btn-clear-log">Clear</button>
            </div>
            <div class="log-content" id="log-content">
                <div class="log-entry">[System] Monitoring initialized</div>
            </div>
        </div>
    </div>

    <script src="../common/js/js-yaml.min.js"></script>
    <script src="../common/js/api.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
