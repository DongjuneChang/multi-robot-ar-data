# ROS2 Environment Command Templates
# 용도: Docker ROS2 컨테이너 명령어 정의 (command_templates 스타일)
# 서버 주소: network_config.yaml의 servers.ros2 참조

# =============================================================================
# ROS2 환경
# =============================================================================
ros2:
  domain_id: 0
  namespace: ""  # UFACTORY는 root namespace 강제

# =============================================================================
# Workspace (Docker container paths)
# =============================================================================
workspace:
  path: "/workspace"
  install: "{workspace.path}/install/setup.bash"

# =============================================================================
# 로봇 설정 (override에서 반드시 설정)
# =============================================================================
robot:
  type: ""           # xarm5, lite6, ur5e, ur3e
  group_name: ""     # MoveIt planning group name
  moveit_package: "" # xarm_moveit_config, ur_moveit_config

# =============================================================================
# Foxglove Bridge
# =============================================================================
foxglove:
  port: 8765

# =============================================================================
# TCP Endpoint
# =============================================================================
# NOTE: TCP Endpoint 포트는 network_config.yaml의 servers.ros2에서 정의됨
# 이 파일에서는 중복 정의하지 않음 (Single Source of Truth)
# 참조: shared_data/config/network_config.yaml → servers.ros2.*.port

# =============================================================================
# Commands (command_templates 스타일)
# =============================================================================
commands:
  # --- Foxglove Bridge ---
  foxglove_bridge:
    description: "Start Foxglove Bridge for web visualization"
    template: "ros2 launch foxglove_bridge foxglove_bridge_launch.xml port:={foxglove.port}"
    defaults: {}

  # --- MoveIt Launch ---
  moveit_fake:
    description: "Launch MoveIt in fake/simulation mode"
    template: "ros2 launch {robot.moveit_package} {robot.type}_moveit_fake.launch.py"
    defaults: {}

  moveit_real:
    description: "Launch MoveIt for real robot"
    template: "ros2 launch {robot.moveit_package} {robot.type}_moveit_realmove.launch.py"
    defaults: {}

  moveit_gazebo:
    description: "Launch MoveIt with Gazebo simulation"
    template: "ros2 launch {robot.moveit_package} {robot.type}_moveit_gazebo.launch.py"
    defaults: {}

  # --- Robot Controller ---
  controller:
    description: "Robot action controller (IK solver + joint publisher)"
    template: "ros2 run multi_hri_utils xarm_action_controller_v3"
    defaults: {}

  # --- Visualization ---
  visualization_launch:
    description: "Launch visualization system (current_pose + path_planner + markers)"
    template: "ros2 launch demo robot_visualization.launch.py"
    defaults: {}

  visualizer:
    description: "Target pose visualizer node"
    template: "ros2 run multi_hri_utils target_pose_visualizer_node"
    defaults: {}

  current_pose:
    description: "Current pose publisher"
    template: "ros2 run multi_hri_utils current_pose_publisher"
    defaults: {}

  # --- Pattern Test ---
  pattern_service:
    description: "Pattern test service (waypoint patterns)"
    template: "ros2 run demo pattern_test_service_v2"
    defaults: {}

  # --- TCP Endpoint (Unity 통신) ---
  tcp_endpoint:
    description: "ROS TCP Endpoint for Unity communication"
    template: "ros2 launch demo tcp_endpoint_with_ip.launch.py"
    defaults: {}

  # --- World TF ---
  world_tf:
    description: "Static TF publisher (world -> link_base)"
    template: "ros2 run tf2_ros static_transform_publisher 0 0 0 0 0 0 world link_base"
    defaults: {}

  # --- Path Planner ---
  path_planner:
    description: "MoveIt path planner node"
    template: "ros2 run multi_hri_utils unified_path_planner"
    defaults: {}

# =============================================================================
# Services (Foxglove/roslibjs에서 호출)
# =============================================================================
services:
  pattern_start:
    description: "Start pattern test"
    name: "/start_pattern_test"
    type: "std_srvs/srv/Trigger"

  pattern_stop:
    description: "Stop pattern test"
    name: "/stop_pattern_test"
    type: "std_srvs/srv/Trigger"

  pattern_preview:
    description: "Preview pattern (show markers without moving)"
    name: "/preview_pattern_test"
    type: "std_srvs/srv/Trigger"

  path_planning_start:
    description: "Start path planning visualization"
    name: "/start_path_planning"
    type: "std_srvs/srv/Trigger"

  path_planning_stop:
    description: "Stop path planning visualization"
    name: "/stop_path_planning"
    type: "std_srvs/srv/Trigger"

# =============================================================================
# Topics (Foxglove subscribe/publish)
# =============================================================================
topics:
  target_pose:
    description: "Target pose for robot end-effector"
    name: "/target_pose"
    type: "geometry_msgs/msg/PoseStamped"

  current_pose:
    description: "Current end-effector pose"
    name: "/current_pose"
    type: "geometry_msgs/msg/PoseStamped"

  joint_states:
    description: "Joint states"
    name: "/joint_states"
    type: "sensor_msgs/msg/JointState"

  test_status:
    description: "Pattern test status"
    name: "/test_status"
    type: "std_msgs/msg/String"

  target_reached:
    description: "Target reached notification"
    name: "/target_reached"
    type: "std_msgs/msg/Bool"

# =============================================================================
# Config
# =============================================================================
config:
  default_mode: "fake"  # fake, real, gazebo
